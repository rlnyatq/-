Develop a C++ program that correctly implements the algorithm required by the problem above, satisfying all given conditions and handling all edge cases.
